---
title_full: "findPvalueCutoff: A R Package To Estimate P-value Cutoff For Selecting Differentially Expressed Genes"

title_short: Select Differentially Expressed Genes At 95 Percent Confidence Level

# one of `Original Paper`, `Discovery Note`, `Application Note`, `Review`, `Letter to the Editor`, `Conference Paper`    
subject_section: Application Note

access_date:
  - day: DD
    month: MM
    year: YY
    
author:
  - name: Vijaykumar Yogesh Muley
    affiliation: "1"
  - name: Alfredo Varela-Echavarría
    affiliation: "1"
      
address:
  - code: 1
    address: Instituto de Neurobiología, Universidad Nacional Autónoma de México, Querétaro, Mexico

# Full email address to be given, preferably an institution email address.  
corresponding_author_text: "To whom correspondence should be addressed. E-mail: vijay.muley\\@comunidad.unam.mx"
corresponding_author_email: "vijay.muley\\@comunidad.unam.mx"
  
motivation: |
  Differential gene expression analysis is useful in understanding dynamic and spatio-temporal activities of genes. It invovles testing thousands of hypothesis and assigning p-values to genes against the null hypothesis that the genes's expression changed in two different physiological contexts. There are two important questions remain debated in this field that are 1) whether p-values adjusted for multiple hypothesis testing, and 2) whether adjusted p-value cutoff of 0.05 should be used for selecting differetially expressed genes.
  
results: |
  Our results suggest that the number of differentially expressed genes at p-value cutoff of 0.05 increased proportional to the sample size used for analysis, and multiple hypothesis testing has only a marginal effect on reducing the number of genes differentially expressed. I propose a findPvalueCutoff R package which uses permutation resampling procedure to overcome both problems and select differentially expressed genes with an estimated 95 percent accuracy. 

availability: |
  The software is implemented as R package and is freely available for download from GitHub at ([https://github.com/vijaykumarmuley/findPvalueCutoff](https://github.com/vijaykumarmuley/findPvalueCutoff/)).

supplementary_info: |
  Supplementary data are available at Bioinformatics Online.

output:
  rticles::bioinformatics_article:
    citation_package: natbib
    
bibliography: manuscript.bib
---


Introduction
============

Differential gene expression analysis (DGEA) helps in understanding the activity of genes between physiological contexts (usually two physiologic groups). It’s a hypothesis testing approach with two competing hypotheses or claims. The null hypothesis claims that the expression of a gene has no change in two different physiological conditions, while the alternate hypothesis states that it does and a gene is considered a differentially expressed gene(s) (DEG). A p-value is the probability of observing the expression change at least as extreme as observed under the null hypothesis or by chance alone. So, the smaller the p-value, the stronger the evidence against the null hypothesis, and the less likely that the change would have been observed under the null hypothesis. The p-value significance level serves as a cutoff, and defines how much evidence we require to reject null hypothesis in favor of alternative hypothesis. The commonly used p-value cutoff is 0.05 or less at which we accept the alternative hypothesis and assume that the expression of a gene has changed in two different physiological contexts and may have functional relevance to them. If the p-value is greater than 0.05, we accept the null hypothesis. In practice, we usually have thousands of genes and hence test thousands of hypotheses. Let’s assume that the number of hypothesis tested are 100, then at p-value cutoff of 0.05, 5 null hypotheses would be rejected just by chance. So, higher number of DEG would be found by chance when the higher number of hypotheses tested. Therefore, we adjust (or correct) p-values for multiple hypothesis testing. Historically, p-value adjustment and 0.05 cutoff are highly debated topics in statistics. Fisher proposed 0.05 significance level using a sample size of four in each of the compared groups, while sample size usually exceeds enormously in this era. The larger the sample size, the smaller the p-value will be observed even if the null hypothesis is true. Hence, p-value cutoff should be data driven but not 0.05. To circumvent this problem, I propose a method to estimate false positive error rate (FPR) at specific p-value cutoffs and choose a cutoff where observed error rate is five percent or less using permutation resampling method. This data-driven approach avoids using arbitrary 0.05 p-value cutoff, and allows detection of differentially expressed genes at 95% confidence level. 

# Approach

Let’s assume that the DGEA is performed and resulting p-values (unadjusted) are assigned to genes based on their expression changes in two groups of samples. These original p-values (original sample) can be used to create a random dataset (control experiment) by shuffling their order in a vector. The resulting randomized vector is called a permutation resample, and technique is called permutation resampling without replacement (Chihara and Hesterberg 2018). The original sample and the permutation resample can be used to compute how many genes are expected to differentially expressed by chance alone at a specific p-value threshold. Let’s assume that the p-value threshold is set to 0.05. I count how many genes have 0.05 or less p-values in the original p-value vector and consider them as true positives. Then, I count how many of these true positive genes assigned p-value 0.05 or less in a permutation resample. Since these genes are assigned p-values 0.05 or less even after randomization, I consider them false positives. The ratio of true and false positives was computed which represents the FPR that would be expected by chance in the original sample when analyzed under the same conditions (the p-value threshold) after randomization. To get a robust estimate, permutation resampling is repeated to create 10,000 resamples of original sample. This gives rise to a 10,000 FPR at 0.05 p-value cutoff and forms a permutation distribution. The mean of the distribution is used as a representative FPR at given p-value cutoff. In practice, FPR are calculated at a series of p-value cutoffs. The p-value at which FPR is five percent or less would be a good threshold to select differentially expressed genes at 95 percent confidence level.
For the convenience of users, I have implemented this simulation-based permutation resampling technique in the R package referred to as findPvalueCutoff. The software is freely available to download from GitHub repository [https://github.com/vijaykumarmuley/findPvalueCutoff](https://github.com/vijaykumarmuley/findPvalueCutoff/). The detailed information on installing and running findPvalueCutoff is also provided with the package. Though time complexity is linear to the number of genes analyzed, it should be less than couple of minutes even for large number of genes on common laptops.


Results
============

The DGEA was performed between samples belonging to two groups from 15 independent gene expression datasets (see Supplementary Note 1 for details). Supplementary Table 1 shows the descriptive statistics on the number of samples in each group used for analyses, the number of DEG expected by chance, significant DEG with unadjusted and adjusted p-value by known multiple hypothesis correction methods at 0.05 cutoff and using unadjusted p-value cutoffs estimated by permutation resampling method proposed in this study. Figure 1A shows that at standard 0.05 p-value cutoff, the number of DEG increased with the increase in the number of samples used for comparison in each group, and for a larger number of samples almost 80% genes showed differential expression (Figure 1A). It was independently confirmed using two gene expression datasets. In each dataset, first three normal and tumour samples were used for DGEA, then added one sample at a time from the remaining samples until the number of normal samples reached its total, and in each round DGEA was performed (see Supplementary Note 2 for details). Consistently, the number of DEG increased proportional to the number of samples used in the two groups at raw and adjusted p-value cutoff of 0.05 (Figure 1B,C). These results suggest that 0.05 p-value cutoff is not suitable when sample size is large (Figue 1A,B,C). On the other hand, permutation resampling based estimated p-value thresholds were robust against the sample size, and less than 20 percent genes showed differential expression in all comparisons. Firas et. al. studied DGEA between breast tissues of mice with and without Gabarap gene in three replicates. They identified 14 DEG with adjusted p-value cutoff of 0.05. I applied findPvalueCutoff which estimated unadjusted p-value cutoff of 0.12 at which 1111 DEG were significant. The expression levels of these genes in samples with and without Gabarap gene is shown in Figure 1D. It clearly shows distinct expression pattern of selected genes suggesting their differential expression, and validites our approach. Overall, these results suggest that permutation resampling based p-value cutoff is not only robust against large sample size datasets but also pick up DEG with smaller sample size when traditional approach misses them.  

Discussion
=============

As shown with succinct examples, p-value cutoff of 0.05 is meaning less when sample size is large, and p-value adjustment has a marginal effect. Conventionally, false negative rate introduced by multiple hypothesis testing is circumvented by filtering genes based on various criteria so that the number of hypothesis tested are small. It is not uncommon to choose arbitrary p-value cutoffs when lower or higher number of DEG obtained by 0.05 p-value cutoff. Furthermore, log-fold change filter often applied when number of DEG more than authors expectations. These biased bypasses significantly impact the reproducibility of the results obtained. Our approach guarantees 95% confidence level in slecting DEG, reproducibility of the results, and no manual interventions. Furthermore, this approach can be extended to any confidence scores as long as it is a vector of thousands of numeric values.        


Acknowledgements {.unnumbered}
==============

Authors acknowledge....for critical reading of the manuscript and testing software.


Funding {.unnumbered}
==============

This work was supported by the Dirección General de Asuntos del Personal Académico-Universidad Nacional Autónoma de México (DGAPA-UNAM) [IA203920 to V.Y.M.].


\begin{figure*}
 \centerline{\includegraphics[width=\textwidth]{figures/Figure.1final.pdf}}
  \caption{Permutation resampling estimates robust p-value threshold irrespective of sample size to select differentially expressed genes. A) X-axis represents gene expression datasets sorted from low to higher number of normal samples. Percentage of differentially expressed genes using unadjusted p-value cutoff, adjusted with Benjamin and Hochberg approach, and p-value cutoff estimated by permutation resampling without replacement. Panel B and C depicts increase in sample size lead to increased number of differentially expressed genes . Panel D shows expression levels of 1111 differentially expression genes selected by permutation resampling based threshold, which were only 14 when adjusted 0.05 p-value cutoff was used (Figure 1A).}
\end{figure*}

